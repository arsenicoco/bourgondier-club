<section class="mt-8">
    <div
        class="bg-gradient-to-r from-white-20 to-pink-50 dark:from-black-20 dark:to-gray-700 rounded-lg p-8 text-center"
    >
        <img
            src="/cta.webp"
            alt="Call to action image"
            class="mx-auto mb-6 max-w-md w-full h-auto rounded-lg"
        />
        <p
            class="text-md leading-relaxed text-gray-700 dark:text-gray-300 max-w-3xl mx-auto mb-8"
        >
            Our meetings take place every <b>Friday</b> in Amsterdam Center, from
            <b>6:30 PM to 8:00 PM</b>. We'll try 5-7 wines, selected for the
            evening's theme. Each meeting will bring you new knowledge, lively
            chats, and feeling of community. Special price for club members -
            ‚Ç¨69/month (4 meetings). You can also attend a single meeting for
            ‚Ç¨25. And of course, part of our community is a chat for wine
            matters, because you can never have too many chats.
        </p>
        <p class="mb-8">
            <a
                href="https://buy.stripe.com/fZudRa5RFbzybFy3Gnes000"
                class="bg-primary text-sm text-white py-3 px-4 rounded-lg hover:bg-red-700 dark:bg-dark-primary dark:hover:bg-red-500 transition-colors mb-8"
            >
                <nobr>Join the club for ‚Ç¨69/month üç∑</nobr>
            </a>
        </p>
        <p>
            <button
                id="book-tasting-btn"
                class="bg-primary text-white text-sm py-3 px-4 rounded-lg hover:bg-red-700 dark:bg-dark-primary dark:hover:bg-red-500 transition-colors"
            >
                <nobr>Attend one meeting for ‚Ç¨25 üç∑</nobr>
            </button>
        </p>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const bookButton = document.getElementById('book-tasting-btn') as HTMLButtonElement;

    // Handle booking
    bookButton.addEventListener('click', async () => {
        bookButton.disabled = true;
        bookButton.textContent = 'Processing...';

        try {
            const response = await fetch('/api/create-checkout-en', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            });

            const data = await response.json();

            if (data.url) {
                window.location.href = data.url;
            } else {
                throw new Error(data.error || 'Failed to create checkout session');
            }
        } catch (error) {
            console.error('Checkout error:', error);
            alert('An error occurred. Please try again.');
            bookButton.disabled = false;
            bookButton.innerHTML = '<nobr>Attend one meeting for ‚Ç¨25 üç∑</nobr>';
        }
    });
});
</script>
